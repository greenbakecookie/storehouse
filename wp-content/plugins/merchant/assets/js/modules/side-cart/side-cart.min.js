jQuery(document).ready(function(c){var t,o,e=(null==(e=merchant)?void 0:e.setting)||{},n=e.side_cart,r=void 0===n?{}:n,i=e.ajax_url,s=e.nonce,d=c("body");function a(){var t=null==r?void 0:r.allowed_devices,e=window.innerWidth;return e<=768&&t.includes("mobile")||!!(768<e&&t.includes("desktop"))}function l(e){var t,n,a;e.length&&i&&s&&(t=e.attr("name"),n=Math.round(parseFloat(e.val()||1)),a=e.closest(".js-side-cart-item"),clearTimeout(o),o=setTimeout(function(){c.ajax({type:"POST",url:i,data:{action:"update_side_cart_quantity",cart_item_key:t,quantity:n,nonce:s},beforeSend:function(){a.length&&a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(t){t&&t.fragments&&(c(document.body).trigger("added_to_cart",[t.fragments,t.cart_hash,e,"side-cart"]),a.length)&&(a.unblock(),c(document).trigger("merchant_destroy_carousel"),c(document).trigger("merchant_init_carousel"))},error:function(t){console.log("Error:",t)}})},350))}c(document).on("click",".js-merchant-side-cart-toggle-handler",function(t){t.preventDefault(),d.toggleClass("merchant-side-cart-show"),c(window).trigger("merchant.side-cart-resize")}),d.on("wc_cart_emptied",function(t,e){c(".merchant_widget_shopping_cart_content").fadeOut(function(){c(this).empty().append('<p class="woocommerce-mini-cart__empty-message">'.concat((null==r?void 0:r.side_cart_empty_message)||"","</p>")).fadeIn()});var n=c(".merchant-side-cart-floating-cart");n.length&&(n.find(".merchant-side-cart-floating-cart-counter").text(0),"cart-not-empty"===(null==r?void 0:r.icon_display))&&n.removeClass("merchant-show")}),r.hasOwnProperty("show_after_add_to_cart_single_product")&&a()&&(n=c("body.single-product").length,e=c(".woocommerce-notices-wrapper").is(":visible")&&!c(".woocommerce-notices-wrapper").is(":empty"),t=c(".wc-block-components-notice-banner").is(":visible")&&!c(".wc-block-components-notice-banner").is(":empty"),n)&&(e||t)&&(d.toggleClass("merchant-side-cart-show"),c(window).trigger("merchant.side-cart-resize")),r.hasOwnProperty("add_to_cart_slide_out")&&a()&&c(document.body).on("added_to_cart",function(t,e,n,a,o){"side-cart"!==o&&"free-gifts"!==o&&d.toggleClass("merchant-side-cart-show"),c(window).trigger("merchant.side-cart-resize")}),r.hasOwnProperty("cart_url")&&a()&&c('[href="'+(null==r?void 0:r.cart_url)+'"]:not(.merchant-side-cart-view-cart-btn)').on("click",function(t){t.preventDefault(),c(window).trigger("merchant.side-cart-resize"),d.toggleClass("merchant-side-cart-show")}),c(document).on("click",".js-merchant-quantity-btn",function(t){t.preventDefault();var e,n,a,o,t=c(this),r=t.closest(".merchant-quantity-wrap").find(".js-update-quantity");r.length&&(e=+(r.val()||1),n=+r.attr("min"),a=+r.attr("max"),o=Math.round(parseFloat(r.attr("step"))),t.hasClass("merchant-quantity-plus")?(e+=o,e=a&&-1!=a?Math.min(e,a):e):t.hasClass("merchant-quantity-minus")&&(e-=o,e=n?Math.max(e,n):e),r.val(e),l(r))}),c(document).on("input change",".js-update-quantity",function(t){t.preventDefault(),l(c(this))}),{init:function(){this.bindEvents(),setTimeout(function(){c(document).trigger("merchant_init_carousel"),c(document).find(".woocommerce-mini-cart-item.merchant-upsell-widget").on("mouseenter",function(){c(document).find(".merchant-mini-cart-upsells.upsells-layout-carousel").hasClass("slick-initialized")&&c(".merchant-mini-cart-upsells.upsells-layout-carousel").slick("slickPause")}),c(document).find(".woocommerce-mini-cart-item.merchant-upsell-widget").on("mouseleave",function(){c(document).find(".merchant-mini-cart-upsells.upsells-layout-carousel").hasClass("slick-initialized")&&c(".merchant-mini-cart-upsells.upsells-layout-carousel").slick("slickPlay")})},500)},bindEvents:function(){c(document).on("change",".merchant-mini-cart-upsell-item-wrap .variation-selector",this.handleVariationChange.bind(this)),c(document).on("click",".add-to-cart-wrap .merchant-upsell-add-to-cart:not(.disabled)",this.handleAddToCartClick.bind(this)),c(document).on("click",".merchant-coupon-form button",this.handleCouponBtnClick.bind(this)),c(document).on("click",".merchant-remove-coupon",this.handleCouponRemoveClick.bind(this)),c(document).on("merchant_init_carousel",this.initCarousel.bind(this)),c(document).on("merchant_destroy_carousel",this.destroyCarousel.bind(this)),c(document).on("added_to_cart",this.handleAddToCart.bind(this)),c(document).on("removed_from_cart",this.handleRemoveFromCart.bind(this))},handleVariationChange:function(t){var e=c(t.target).closest(".merchant-mini-cart-upsell-item-wrap"),n=e.attr("data-variations")&&JSON.parse(e.attr("data-variations"))||[],a=e.find(".variation-selector"),o=(e.attr("data-variation-id",0),{name:c(t.target).attr("data-attribute_name"),value:c(t.target).val()}),r=[],i=n.filter(function(t){return void 0!==t.attributes[o.name.toLowerCase()]&&t.attributes[o.name.toLowerCase()]===o.value});a.each(function(){var t=c(this),e=t.attr("data-attribute_name");i.forEach(function(t){t=t.attributes[e.toLowerCase()];void 0===t||""===t||r.includes(t)||r.push(t)}),o.name.toLowerCase()!==e.toLowerCase()&&t.find("option").each(function(){var t=c(this).attr("value");""!==t&&(r.includes(t)?c(this).show():c(this).hide())})}),this.isAllVariationsSelected(e)?(this.fetchVariationDetails(e,e.attr("data-product-id"),this.getSelectedAttributes(e),this),this.handleAddToCartBtnState(e,!0)):this.handleAddToCartBtnState(e,!1)},fetchVariationDetails:function(e,t,n,a){c.ajax({type:"POST",url:i,data:{action:"merchant_get_variation_data",product_id:t,nonce:null==r?void 0:r.variation_info_nonce,attributes:n},success:function(t){t.success&&(e.attr("data-variation-id",t.data.id),a.updateProductThumbnail(e,t.data.thumbnail_url))},error:function(t){console.log("Error:",t)}})},updateProductThumbnail:function(t,e){t.find(".product-thumbnail a img").attr("src",e)},getSelectedAttributes:function(t){var e={};return t.find(".variation-selector").each(function(){e[c(this).attr("name")]=c(this).val()}),e},handleAddToCartBtnState:function(t,e){t=t.find(".add-to-cart-wrap .merchant-upsell-add-to-cart");e?(t.removeClass("disabled"),t.prop("disabled",!1)):(t.addClass("disabled"),t.prop("disabled",!0))},isAllVariationsSelected:function(t){t=t.find(".variation-selector");return t.length&&t.toArray().every(function(t){return""!==c(t).val()})},handleAddToCartClick:function(t){t.preventDefault();var t=c(t.currentTarget),e=t.closest(".merchant-mini-cart-upsell-item-wrap"),n=e.attr("data-product-type"),a=e.attr("data-product-id"),e=e.attr("data-variation-id");"variable"===n&&"0"!==e?this.addToCart(this,"variable",a,e,t):"simple"===n?this.addToCart(this,"simple",a,e,t):console.log("Unsupported product type:",n)},addToCart:function(e,t,n,a,o){c.ajax({type:"POST",url:i,data:{action:"merchant_side_cart_upsells_add_to_cart",product_id:n,variation_id:a,nonce:s},beforeSend:function(){o.addClass("loading")},success:function(t){e.handleSuccess(t)},error:function(t){e.handleError(t)},complete:function(){o.removeClass("loading")}})},handleSuccess:function(t){t.data.fragments&&(c(document).trigger("merchant_destroy_carousel"),c(document.body).trigger("added_to_cart",[t.data.fragments,t.data.cart_hash,c(".merchant-upsell-add-to-cart"),"side-cart"]),c(document).trigger("merchant_init_carousel"))},handleError:function(t){console.log("Error:",t)},handleAddToCart:function(t,e,n,a,o){c(document).trigger("merchant_destroy_carousel"),c(document).trigger("merchant_init_carousel")},handleRemoveFromCart:function(t){c(document).trigger("merchant_destroy_carousel"),c(document).trigger("merchant_init_carousel")},initCarousel:function(){var t=c(document).find(".merchant-mini-cart-upsells.upsells-layout-carousel");"carousel"!==(null==r?void 0:r.upsells_style)||t.hasClass("slick-initialized")||t.slick({infinite:!0,arrows:!0,slidesToShow:1,dots:!1,autoplay:!1,fade:!0,cssEase:"linear",pauseOnFocus:!0,pauseOnHover:!0,prevArrow:'<button type="button" class="slick-prev"><</button>',nextArrow:'<button type="button" class="slick-next">></button>',rtl:"1"===(null==r?void 0:r.is_rtl)})},destroyCarousel:function(){var t=c(document).find(".merchant-mini-cart-upsells.upsells-layout-carousel");"carousel"===(null==r?void 0:r.upsells_style)&&t.hasClass("slick-initialized")&&t.slick("unslick")},handleCouponBtnClick:function(t){t.preventDefault();var t=c(t.currentTarget).closest(".merchant-coupon-form"),e=t.find(".coupon_code").val();""!==e&&this.applyCoupon(this,e,t)},applyCoupon:function(e,t,n){c.ajax({type:"POST",url:i,data:{action:"merchant_side_cart_apply_coupon",coupon_code:t,nonce:s},beforeSend:function(){n.addClass("loading")},success:function(t){e.handleCouponSuccess(t)},error:function(t){e.handleCouponError(t)},complete:function(){n.removeClass("loading")}})},removeCoupon:function(e,t){c.ajax({type:"POST",url:i,data:{action:"merchant_side_cart_remove_coupon",coupon_code:t,nonce:s},beforeSend:function(){},success:function(t){e.handleCouponSuccess(t)},error:function(t){e.handleCouponError(t)}})},handleCouponSuccess:function(t){void 0!==(null==t?void 0:t.fragments)&&(c(document).trigger("merchant_destroy_carousel"),c(document.body).trigger("added_to_cart",[t.fragments,t.cart_hash,c(".merchant-coupon-form button"),"side-cart"]),c(document).trigger("merchant_init_carousel"))},handleCouponError:function(t){console.log("Error:",t)},handleCouponRemoveClick:function(t){t.preventDefault();t=c(t.currentTarget).attr("data-coupon");this.removeCoupon(this,t)}}.init()});