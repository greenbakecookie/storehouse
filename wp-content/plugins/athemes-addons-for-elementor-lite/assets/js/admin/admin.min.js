"use strict";(function(e,a,t,s){e(t).ready(function(){function s(){var a=e(".athemes-addons-modules-list-item");a.hide(),a.each(function(){var a=e(this),t=("all"===c.category||(a.data("category"),c.category),"all"===c.status||a.data("status")===c.status),s="all"===c.freePro||a.data("type")===c.freePro;t&&s&&a.show()}),n()}function n(){e(".athemes-addons-modules-category").show(),e(".athemes-addons-modules-category").each(function(){var a=e(this),t=a.find(".athemes-addons-modules-list-item:visible");0===t.length&&a.hide()})}e(".athemes-addons-module-page-button-action-activate, .athemes-addons-module-page-button-action-deactivate").on("click",function(t){var s=e(this),n=s.hasClass("athemes-addons-module-page-button-action-activate");s.toggleClass("athemes-addons-module-page-button-action-activate athemes-addons-module-page-button-action-deactivate"),setTimeout(()=>{s.find(".saved-label").css("opacity","1"),setTimeout(()=>{s.find(".saved-label").css("opacity","0")},2e3)},1e3);var o=n?"athemes_addons_module_activate":"athemes_addons_module_deactivate";a.wp.ajax.post(o,{module:s.data("module"),nonce:a.athemes_addons_elementor.nonce}).done(function(){var a=n;e("body").toggleClass("athemes-addons-module-disabled",!a).toggleClass("athemes-addons-module-enabled",a),e(".athemes-addons-module-action").toggleClass("athemes-addons-enabled",a),e(".athemes-addons-module-question-list-dropdown").toggleClass("athemes-addons-show",!a)})});var o=e(".athemes-addons-notifications-sidebar");if(o.length){var d=e(".athemes-addons-notifications");d.on("click",function(t){t.preventDefault();var s=e(this),n=o.find(".athemes-addons-notification:first-child .athemes-addons-notification-date").data("raw-date");o.toggleClass("opened"),s.hasClass("read")||e.post(a.athemes_addons_elementor.ajax_url,{action:"athemes_addons_notifications_read",nonce:a.athemes_addons_elementor.nonce,latest_notification_date:n},function(e){e.success&&setTimeout(function(){s.addClass("read")},2e3)})}),e(a).on("scroll",function(){a.pageYOffset>60&&(o.addClass("closing"),setTimeout(function(){o.removeClass("opened"),o.removeClass("closing")},300))}),e(".athemes-addons-notifications-sidebar-close").on("click",function(e){e.preventDefault(),o.addClass("closing"),setTimeout(function(){o.removeClass("opened"),o.removeClass("closing")},300)})}var i=e(".athemes-addons-dashboard-tabs-nav");if(i.length){var l=i.find("a");l.on("click",function(a){a.preventDefault();var t=e(this).data("tab");e(this).addClass("active").siblings().removeClass("active"),e(".athemes-addons-dashboard-tab-page").each(function(){e(this).attr("id")===t?e(this).addClass("active"):e(this).removeClass("active")})})}var c={category:"all",status:"all",freePro:"all"},m=e(".athemes-addons-modules-filter-button-category");m.on("change",function(a){var t=e(this).val();if(c.status="all",c.freePro="all",e('input[name="athemes-addons-status-filter"][value="all"]').prop("checked",!0),e('input[name="athemes-addons-free-pro-filter"][value="all"]').prop("checked",!0),"all"===t)return e(".athemes-addons-modules-category").show(),void e(".athemes-addons-modules-list-item").show();var s=e(".athemes-addons-modules-category").filter(function(){var a=e(this).find('.athemes-addons-modules-list-item[data-category="'+t+'"]').length>0;return a}).first();s.length&&e("html, body").animate({scrollTop:s.offset().top-100},500)});var r=e('input[name="athemes-addons-status-filter"]');r.on("change",function(a){var t=e(this).val();c.status=t,s()});var h=e('input[name="athemes-addons-free-pro-filter"]');h.on("change",function(a){var t=e(this).val();c.freePro=t,s()});var u=e(".athemes-addons-modules-search");u.on("keyup",function(a){var t=e(this).val().toLowerCase(),s=e(".athemes-addons-modules-list-item");s.hide(),s.each(function(){var a=e(this),s=a.data("title").toLowerCase(),n=a.data("keywords")?a.data("keywords").toLowerCase():"";(s.indexOf(t)>-1||n.indexOf(t)>-1)&&a.show()}),n()}),e(".aafe-save-settings").on("click",function(){var t={};e(this).text(a.athemes_addons_elementor.saving),e('.athemes-addons-module-page-setting-fields input[type="text"]').each(function(){var a=e(this).attr("name"),s=e(this).val();t[a]=s}),e(".athemes-addons-module-page-setting-field-multicheckbox").each(function(){var a=e(this).find('input[type="hidden"]').attr("name"),s=e(this).find('input[type="hidden"]').val();t[a]=s});var s={action:"aafe_save_settings",nonce:a.athemes_addons_elementor.nonce,fields:t};e.ajax({type:"POST",url:a.athemes_addons_elementor.ajax_url,data:s,success:function(t){e(".aafe-save-settings").text(a.athemes_addons_elementor.saved),setTimeout(()=>{e(".aafe-save-settings").text(a.athemes_addons_elementor.save)},2e3)},error:function(e){console.error(e)}})}),e(".athemes-addons-module-page-setting-field-multicheckbox").each(function(){var a=e(this),t=a.find('input[type="checkbox"]');t.on("change",function(){var s=[];t.each(function(){e(this).is(":checked")&&s.push(e(this).val())}),a.find('input[type="hidden"]').val(s.join(",")).trigger("change")})}),e(t).on("athemes-addons-display-conditions-select2-initalize",function(t,s){var n=e(s),o=(n.closest(".athemes-addons-display-conditions-control"),n.find(".athemes-addons-display-conditions-select2-type")),d=o.find("select"),i=n.find(".athemes-addons-display-conditions-select2-condition"),l=i.find("select"),c=n.find(".athemes-addons-display-conditions-select2-id"),m=c.find("select");d.select2({width:"100%",minimumResultsForSearch:-1}),d.on("select2:select",function(e){o.attr("data-type",e.params.data.id)}),l.select2({width:"100%"}),l.on("select2:select",function(a){var t=e(a.params.data.element);t.data("ajax")?c.removeClass("hidden"):c.addClass("hidden"),m.val(null).trigger("change")});var r=l.find(":selected").data("ajax");r&&c.removeClass("hidden"),m.select2({width:"100%",placeholder:"",allowClear:!0,minimumInputLength:1,ajax:{url:a.athemes_addons_elementor.ajax_url,dataType:"json",delay:250,cache:!0,data:function(e){return{action:"athemes_addons_templates_display_conditions_select_ajax",term:e.term,nonce:a.athemes_addons_elementor.nonce,source:l.val()}},processResults:function(e,a){return e.success?{results:e.data}:{}}}})}),e(t).on("click",".athemes-addons-display-conditions-modal-toggle",function(a){a.preventDefault();var s=e(this),n=wp.template("athemes-addons-display-conditions-template"),o=s.closest(".athemes-addons-display-conditions-control"),d=o.find(".athemes-addons-display-conditions-modal");if(d.data("initialized"))d.toggleClass("open");else{var i=o.data("condition-settings");o.append(n(i));var l=o.find(".athemes-addons-display-conditions-modal-content-list-item").not(".hidden");l.length&&l.each(function(){e(t).trigger("athemes-addons-display-conditions-select2-initalize",this)}),d=o.find(".athemes-addons-display-conditions-modal"),d.data("initialized",!0),d.addClass("open")}}),e(t).on("click",".athemes-addons-display-conditions-modal",function(a){a.preventDefault();var t=e(this);e(a.target).is(t)&&e(".athemes-addons-display-conditions-modal").removeClass("open")}),e(t).on("click",".athemes-addons-display-conditions-modal-add",function(a){a.preventDefault();var s=e(this),n=s.closest(".athemes-addons-display-conditions-control"),o=n.find(".athemes-addons-display-conditions-modal"),d=o.find(".athemes-addons-display-conditions-modal-content-list"),i=o.find(".athemes-addons-display-conditions-modal-content-list-item").first().clone(),l=s.data("condition-group");i.removeClass("hidden"),i.find(".athemes-addons-display-conditions-select2-condition").not('[data-condition-group="'+l+'"]').remove(),d.append(i),e(t).trigger("athemes-addons-display-conditions-select2-initalize",i)}),e(t).on("click",".athemes-addons-display-conditions-modal-remove",function(a){a.preventDefault();var t=e(this).closest(".athemes-addons-display-conditions-modal-content-list-item");t.remove()}),e(t).on("click",".athemes-addons-display-conditions-modal-save",function(a){a.preventDefault();var s=[],n=e(this),o=n.closest(".athemes-addons-display-conditions-control"),d=o.find(".athemes-addons-display-conditions-modal"),i=o.find(".athemes-addons-display-conditions-textarea"),l=d.find(".athemes-addons-display-conditions-modal-content-list-item").not(".hidden");l.each(function(){var a=e(this);s.push({type:a.find('select[name="type"]').val(),condition:a.find('select[name="condition"]').val(),id:a.find('select[name="id"]').val()})}),i.val(JSON.stringify(s)).trigger("change"),e(t).trigger("athemes-addons-display-conditions-update",i)}),e(t).on("athemes-addons-display-conditions-update",function(t,s){var n=e(s),o=n.val();e.post(a.athemes_addons_elementor.ajax_url,{action:"athemes_addons_update_template_conditions",nonce:a.athemes_addons_elementor.nonce,template_id:n.parents(".athemes-addons-tb-element").data("template-id"),conditions:o},function(e){e.success&&console.log(e)})}),e(t).on("click",".aafe-delete-template",function(t){t.preventDefault();var s=e(this),n=s.parents(".athemes-addons-tb-element").data("template-id");s.children(".dashicons").addClass("dashicons-update-alt").removeClass("dashicons-edit").css("animation","aafe-spin 2s infinite"),e.post(a.athemes_addons_elementor.ajax_url,{action:"athemes_addons_delete_template",nonce:a.athemes_addons_elementor.nonce,template_id:n},function(e){e.success&&s.closest(".athemes-addons-tb-element").fadeOut()})}),e(t).on("click",".aafe-edit-template",function(t){t.preventDefault();var s=e(this),n=s.parents(".athemes-addons-tb-element").data("template-id");s.children(".dashicons").toggleClass("dashicons-edit dashicons-update-alt").css("animation","aafe-spin 2s infinite");var o=a.athemes_addons_elementor.admin_url+"post.php?post="+n+"&action=elementor",d=e("#athemes-addons-elementor-iframe");d.siblings(".athemes-addons-iframe-loader").show(),d.attr("src",o),d.parent().addClass("open"),d.siblings(".athemes-addons-iframe-loader").fadeOut(),d.on("load",function(){s.children(".dashicons").addClass("dashicons-edit").removeClass("dashicons-update-alt").css("animation","none")})}),e(t).on("click",".aafe-create-template",function(t){t.preventDefault();var s=e(this),n=s.data("template-type"),o=s.data("template-label"),d=e("#athemes-addons-elementor-iframe");d.siblings(".athemes-addons-iframe-loader").show(),e.post(a.athemes_addons_elementor.ajax_url,{action:"athemes_addons_create_template",nonce:a.athemes_addons_elementor.nonce,template_type:n,template_label:o},function(t){if(t.success){s.children(".dashicons").toggleClass("dashicons-plus-alt2 dashicons-update-alt").css("animation","none");var n=t.data.template_id,o=a.athemes_addons_elementor.admin_url+"post.php?post="+n+"&action=elementor";d.attr("src",o),d.parent().addClass("open"),d.siblings(".athemes-addons-iframe-loader").fadeOut(),d.on("load",function(){e.post(a.athemes_addons_elementor.ajax_url,{action:"athemes_addons_get_templates",nonce:a.athemes_addons_elementor.nonce},function(a){a.success&&e('.athemes-addons-theme-builder-elements[data-type="templates"]').html(a.data)})})}})}),e(t).on("click",".athemes-addons-close-modal",function(a){a.preventDefault(),e("#athemes-addons-elementor-iframe").parent().removeClass("open"),e("#athemes-addons-elementor-iframe").attr("src","")}),e(t).on("change",".aafe-header-type-select",function(t){var s=e(this),n=s.val(),o=s.parents(".athemes-addons-tb-element").data("template-id");e.post(a.athemes_addons_elementor.ajax_url,{action:"athemes_addons_header_type",nonce:a.athemes_addons_elementor.nonce,template_id:o,header_type:n},function(e){e.success&&setTimeout(()=>{s.prev(".saved-label").css("opacity","1"),setTimeout(()=>{s.prev(".saved-label").css("opacity","0")},2e3)},500)})}),e(t).on("click",".aafe-upgrade",function(e){e.preventDefault(),a.open("https://athemes.com/addons/","_blank")})})})(jQuery,window,document);